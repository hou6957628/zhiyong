function TrialCalculation(){var e=500,t=2e5;this.trialResult={},this.monthArray=[3,6,12],this.repaymentType=2,this.rateArray=["0.05","1.0589","0.8828","0.8197"],this.errorMsg={1:"＊输入金额无效",2:"＊单笔借款最低500元",3:"＊授信额度最高"+t,4:"＊借款金额必须是100的整数倍",5:"日费率枚举匹配错误",6:"期限枚举匹配错误"},this.inArray=function(e,t){for(var i in t)if(t[i].toString()==e)return!0;return!1},this.betweenDate=function(e,t){return parseInt(Math.abs(e-t)/1e3/60/60/24)},this.money=2e4,this.rate=this.rateArray[0],this.month=this.monthArray[0],this.rateSjsh=.05,this.setMoney=function(i){return i=parseInt(i),isNaN(i)?1:e>i?2:i>t?3:/^(([\d]*)00)$/.test(i)?(this.money=i,this.calculation(),!0):4},this.setMonth=function(e){return e=parseInt(e),this.inArray(e,this.monthArray)?(this.month=e,this.calculation(),!0):6},this.setRepaymentType=function(e){this.repaymentType=e},this.calculation=function(){this.trialResult={};var e=this,t=new Date,i=(this.money/this.month).toFixed(2),n=this.money,o=function(t,i,n,o){e.trialResult[t]||(e.trialResult[t]={}),e.trialResult[t].date=void 0==o?t+1:o.format("yyyy-MM-dd"),e.trialResult[t].payments=(parseFloat(i)+parseFloat(n)).toFixed(2),e.trialResult[t].principal=i,e.trialResult[t].interest=n.toFixed(2)},a=function(t,i){return t+1<e.month?i:(e.money-parseFloat(i)*(e.month-1)).toFixed(2)};if(2==e.repaymentType){e.rate=e.rateArray[e.monthArray.indexOf(e.month)+1];for(var r=n*parseFloat(e.rate)/100,s=0;s<e.month;s++){var l=a(s,i);o(s,l,r)}}else if(3==e.repaymentType){e.rate=e.rateSjsh,i=e.money.toFixed(2);var c=new Date(t),l=i;t.getDate()>28&&t.setDate(28),t.setMonth(t.getMonth()+1);var r=n*parseFloat(e.rate)/100*e.betweenDate(c,t);o(0,l,r,t)}}}function refreshImgCode(e){e.attr("src",_requestRoot+"servlet/validateCodeServlet?terminal="+_terminal+"&d="+Math.random())}function growingRegister(e){if(_vds&&"function"==typeof _vds.track){var t=1==e?"PC":"Mobile";_vds.track("jietiao_register",{platform:t})}}Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e};var isTrial=!0,_requestRoot="https://mkt.360jie.com.cn/",_terminal="";(new Fingerprint2).get(function(e,t){_terminal=e,$("input[name='terminal']").val(_terminal),refreshImgCode($(".refreshImg"))}),$(function(){function e(e){s.empty(),e!==!0?(isTrial=!1,s.text(a.errorMsg[e]),$("#repayment").text("？？？")):(isTrial=!0,r=a.trialResult,$("#repayment").text(parseFloat(r[0].payments)))}function t(){$("#reg2 .input-box input").val(""),C()}function i(e,t){e.click(function(e){$("html,body").animate({scrollTop:t.offset().top},600)})}function n(){}var o=$.cookie("exist_user");o&&($("#reg1").hide(),$("#weixin1").show(),$("#reg2").hide(),$("#weixin2").show(),"Y"==o?($(".new-user-box").hide(),$(".old-user-box").show()):($(".new-user-box").show(),$(".old-user-box").hide()));var a=new TrialCalculation,r="",s=$("#errorTxt");a.calculation(),r=a.trialResult,$("#repayment").text(parseFloat(r[0].payments)),$("#paymentMethod .month").on("click",function(){if(isTrial){$(this).addClass("active").siblings().removeClass("active");var e=$(this).data("type");3==e?($("#timeBox").hide(),$("#repaymentDate").show(),$("#trialTitle").text("到期应还款：")):($("#timeBox").show(),$("#repaymentDate").hide(),$("#trialTitle").text("每月还款金额：")),a.setRepaymentType(e),a.calculation(),r=a.trialResult,$("#repayment").text(parseFloat(r[0].payments)),3==e&&$("#dateTime").text(r[0].date)}}),$("#selectTime .time").on("click",function(){isTrial&&($(this).addClass("active").siblings().removeClass("active"),e(a.setMonth($(this).data("time"))))}),$("#Amount").on("keyup",function(){e(a.setMoney($(this).val())),""==$(this).val()&&s.empty()});var l=$(".nav .active").index();$("#appDown,.get-btn").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),$(".app-down-popup-box").show(),$(".app-down-popup-bg,.app-down-con").addClass("scale")}),$(".app-down-popup-box .close").on("click",function(){$(".app-down-popup-box").hide(),$(".app-down-popup-bg,.app-down-con").removeClass("scale"),$(".nav a").eq(l).addClass("active").siblings().removeClass("active")}),$("#kefuBtn").on("click",function(){$(".kefu-popup-box").show()}),$("#closeKefu").on("click",function(){$(".kefu-popup-box").hide()});for(var c=function(e,t,i){var n=1500,o=0;i&&(n=i),t.html(e),t.parent().show(),o=t.outerWidth(),t.css({"margin-left":-(o/2)+"px"}),setTimeout(function(){t.parent().hide()},n)},u=new Array,d=0,p=[7988,21588,35288,48188,8988,22988,36988,49888,9988,23588,37288,51588,10188,25988,38588,53988,11988,26588,41988,55888],f=0;5>f;f++){u[f]=new Array;for(var h=0;4>h;h++)u[f][h]=p[d],d++}for(var m=new Array,v=0,x=[79,83,87,92,80,85,90,94,81,86,91,95,82,88,93,97,84,89,96,98],f=0;5>f;f++){m[f]=new Array;for(var h=0;4>h;h++)m[f][h]=x[v],v++}$(".calculateBtn").on("click",function(){var e=$("input[name='sex']:checked").val(),i=$("input[name='age']:checked").val(),n=$("input[name='creditCard']:checked").val(),o=$(".select-box-list").find(".tip-popup"),a=0,r="";if(refreshImgCode($("#main-form2").find(".refreshImg")),!e)return void c("请选择您的性别",o);if(!i)return void c("请选择您的年龄",o);if(!n)return void c("请选择信用卡最高额度",o);var s=u[i][n];r=m[i][n]+"%";var l=new Date,d=l.getHours();d>=0&&6>=d&&(s-=500),d>=6&&12>=d&&(s-=300),d>=18&&24>=d&&(s+=300),a=s.toString();var p=/(?=(?!(\b))(\d{3})+$)/g;a=a.replace(p,","),$("#pointTxt").text(a),$("#percentTxt").text(r),$(".popup-box").show(),t()}),$("#closePopup").on("click",function(){$(".popup-box").hide(),refreshImgCode($("#main-form1").find(".refreshImg"))}),$("#closeNav").on("click",function(){$(".fixed-nav").stop(!0).animate({left:"-10000px"},500),setTimeout(function(){$(".fixed-nav").hide(),$(".fixed-box").hide(),$(".fixed-height").hide(),$(".left-nav-btn").show()},500)}),$("#showNav").on("click",function(){$(".fixed-nav").show(),$(".fixed-box").show(),$(".left-nav-btn").hide(),$(".fixed-height").show(),setTimeout(function(){$(".fixed-nav").stop(!0).animate({left:"0px"},500)},10)}),$("#submitBtn1").on("click",function(){b("main-form1")}),$("#submitBtn2").on("click",function(){b("main-form2")}),$("#btnSendCode1").on("click",function(){$(this).hasClass("disabled")||y("main-form1",$(this))}),$("#btnSendCode2").on("click",function(){$(this).hasClass("disabled")||y("main-form2",$(this))}),$(".input-box input").on("keyup",function(){$(this).parent().removeClass("error")});var g,b=function(e){var t=$("#"+e).find("input[name='mobile']"),i=$("#"+e).find("input[name='smsCode']"),n=$("#"+e).find(".tip-popup");return t.val()?/^1[3-8]\d{9}$/.test(t.val())?i.val()?/^[0-9]*$/.test(i.val())?void $.ajax({type:"get",url:_requestRoot+"activity/pcguide/cdreg",data:$("#"+e).serialize(),dataType:"jsonp",jsonp:"callback",success:function(e){"1"==e.status||"3004"==e.status?($("#reg1").hide(),$("#weixin1").show(),$("#reg2").hide(),$("#weixin2").show(),e.existUser&&"Y"==e.existUser?($(".new-user-box").hide(),$(".old-user-box").show(),$.cookie("exist_user","Y",{path:"/",expires:1/48})):($(".new-user-box").show(),$(".old-user-box").hide(),$.cookie("exist_user","N",{path:"/",expires:1/48}),growingRegister(!0))):c(e.message,n)},beforeSend:function(){$("#"+e).find(".loading-box").show()},complete:function(){$("#"+e).find(".loading-box").hide()},error:function(){c("网络异常，请稍后再试",n)}}):(i.parent().addClass("error"),void c("手机短信验证必须为数字",n)):(i.parent().addClass("error"),void c("手机短信验证不能为空",n)):(t.parent().addClass("error"),void c("请填写正确的手机号",n)):(t.parent().addClass("error"),void c("手机号不能为空",n))},y=function(e,t){var i=$("#"+e).find("input[name='mobile']"),n=i.val(),o=$("#"+e).find("input[name='code']"),a=o.val(),r={},s=$("#"+e).find(".yzm"),l=$("#"+e).find(".tip-popup");if(!n)return i.parent().addClass("error"),void c("手机号不能为空",l);if(!/^1[3-8]\d{9}$/.test(n))return i.parent().addClass("error"),void c("请填写正确的手机号",l);if($("#"+e).find("input[name='code']").is(":visible")){if(!a)return o.parent().addClass("error"),void c("图形验证不能为空",l);r={mobile:n,terminal:_terminal,code:a}}else r={mobile:n,terminal:_terminal};t.addClass("disabled"),$.ajax({type:"get",url:_requestRoot+"activity/pcguide/cdsms",data:r,dataType:"jsonp",jsonp:"callback",success:function(i){"1"==i.status?(w(60,t),$("#"+e).find("input[name='cdKey']").val(i.cdKey)):"2"==i.status?(s.show(),t.removeClass("disabled")):(c(i.message,l),t.removeClass("disabled"),refreshImgCode($("#"+e).find(".refreshImg")),C())},beforeSend:function(){$("#"+e).find(".loading-box").show()},complete:function(){$("#"+e).find(".loading-box").hide()},error:function(){c("网络异常，请稍后再试",l),t.removeClass("disabled"),C()}})},w=function(e,t){return 1==e?void t.text("重发").removeClass("disabled"):(t.html("重发(<i>"+--e+"s</i>)"),void(g=setTimeout(function(){w(e,t)},1e3)))},C=function(){clearTimeout(g),$(".btnSendCode").text("获得验证码").removeClass("disabled")};$(".refreshImg").on("click",function(){refreshImgCode($(this))}),i($("#btnMoveToFloor2"),$("#floor2")),-1!=location.search.indexOf("appdown")&&setTimeout(function(){$("html,body").animate({scrollTop:$(".foot-box").offset().top},600)},500);var T,k=!0,R=function(){$("#scrollDiv ul").css("top","-=1px")},M=function(){$.ajax({type:"get",url:_requestRoot+"activity/pcguide/registerData",data:{size:35},dataType:"jsonp",jsonp:"callback",success:function(e){var t="";$.each(e.dataList,function(e,i){t+="<li>"+i.time+i.name+"借款"+i.money+"元.</li>"}),$("#scrollDiv ul").append(t),k&&(T=setInterval(function(){R()},80),k=!1),setTimeout(function(){M()},6e4)}})};$("#scrollDiv ul").hover(function(){clearInterval(T)},function(){T=setInterval(function(){R()},80)}),M(),n.setCursor=function(e,t,i){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,i);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n.select()}},n.getCursorPosition=function(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t},function(e){e.fn.number=function(){return e(this).each(function(){e(this).on("keyup",function(t){var i=(t.which,e(this).val()),o=n.getCursorPosition(e(this)[0]);e(this).val(i.replace(/[^\d*]/g,"")),n.setCursor(e(this)[0],o,o)}).on("keypress",function(t){var i=t.which,o=e(this),a=o.val(),r="",s=o.data("max_value"),l=/^\d*?$/,c=n.getCursorPosition(e(this)[0]);return setTimeout(function(){r=o.val(),(!l.test(r)||s&&parseFloat(r)>=Math.pow(10,s))&&(o.val(a),n.setCursor(o[0],c,c))},100),190==i||i>=48&&57>=i||39==i||37==i||8==i||46==i?!0:!1}).on("paste",function(){var t=e(this),i="",n=t.data("max_value");setTimeout(function(){i=t.val(),t.val(i.replace(/[^\d*]/g,"")),n&&parseFloat(i)>=Math.pow(10,n)&&t.val(i.substr(0,n))},100)})})}}(jQuery),$("#Amount").number(),$(window).scroll(function(){var e=$(window).scrollTop();e>100?($("#backTop").fadeIn(),$(".fixed-box").fadeIn()):($("#backTop").fadeOut(),$(".fixed-box").fadeOut())}),$("#backTop").on("click",function(){$("html,body").animate({scrollTop:0},600)})});